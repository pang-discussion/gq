## SimSwap: An Efficient Framework For High Fidelity Face Swapping

### 一、相关知识

&emsp;&emsp;本篇论文发表于ACMMM2020年，是关于人脸交换的论文，目标是将源人脸的身份转移的目标人脸上，同时保持目标人脸的属性不变。在传统上身份交换的解码器只能够适用于特定的人脸身份，泛化能力不强，本文通过一个ID注入模块改进了这一点。本文的模型架构为**生成器：编码器+ID注入模块+解码器，判别器**。其中ID注入模块包括身份提取模块（ArcFace）和嵌入模块（ID-block = Res-block + AdaIN）。

### 二、方法

<img src="F:\学习\论文笔记\图片\image-20220711174908459.png" alt="image-20220711174908459" style="zoom:80%;" />

&emsp;&emsp;simswap的主要思想是将解码器与图片的身份信息解耦，以便使得生成器可以运用到任意的人脸属性交换。其主要方法是在编码器和解码器之间加入了一个ID注入模块，这样生成器就变成了三个部分：编码器部分用于提取图像特征，特征转换模型用与源与目标图像的特征的转换，解码器则利用图像特征重建最终的输出图像。由于编码器提取的是目标图像的整个特征，里面包含了身份信息和属性信息，因此需要通过损失函数来约束目标图片只是身份信息发生了变化。

&emsp;&emsp;具体的损失函数如下所示。

1. Identity Loss：

&emsp;&emsp;身份损失用来保证生成的图片是与原图片的身份信息相匹配的。实现上是通过ArcFace来提取原图片和生成的图片的身份信息，然后通过余弦相似度得到损失函数。具体公式如2-1所示。
$$
L_{I d}=1-\frac{v_{R} \cdot v_{S}}{\left\|v_{R}\right\|_{2}\left\|v_{S}\right\|_{2}}\tag{2-1}
$$

2. Reconstruction Loss:

重建损失是用来保证生成的人脸与目标人脸相似。具体如公式2-2所示。
$$
L_{\text {Recon }}=\left\|I_{R}-I_{T}\right\|_{1}\tag{2-2}
$$

3. GAN损失和GP损失

这个损失来自于WGAN-GP。

4. **Weak Feature Matching Loss** 

弱特征匹配损失的思想来自于pix2pixHD，经过改变变成了弱特征匹配损失，主要是删除了里面的判别器前几层的特征，具体的如公式2-3所示。另外本文采用了两个判别器，输入分别是原始图片和原始图片的一半，具体的公式如2-4所示。
$$
L_{w F M}(D)=\sum_{i=m}^{M} \frac{1}{N_{i}}\left\|D^{(i)}\left(I_{R}\right)-D^{(i)}\left(I_{T}\right)\right\|_{1}\tag{2-3}
$$

$$
L_{w F M_{-} s u m}=\sum_{i=1}^{2} L_{w F M}\left(D_{i}\right)\tag{2-4}
$$



